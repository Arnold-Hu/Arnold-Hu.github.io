---
title: 博客迁移
date: 2020-02-22 16:02:37
tags: 
- 博客
- blog
- React
---




## 背景

最近学习了React这门前端框架，也算是入门了前端吧，发现比起之前用jQuery写真的方便和规范了很多，就如同java遇到了Spring一样。正好需要拿一个实际的项目练练手，所以就准备重新实现一下我之前的博客。之前的博客是用Hexo框架写的，非常的省心，你基本上要做的只是写markdown的文章，找一个你喜欢的主题，然后再配好各种个性化的配置就可以用了。代价也就是框架十分固定，很难扩展。所以我打算实践一下最近学的内容，从头写一个自己的博客。



## 实现目标

一开始其实我是像综合React和SpringBoot来一起练习一下。但是后面思考了之后发现对于一个个人博客来说，加一个后端接口和数据库还是过于重了，维护起来也十分的麻烦，实现的时间也会加长，不能有一个很好的正反馈，不利于学习。所以最终定的目标就是一个类似于HEXO的框架，要达到两个目标

1. 利于使用，增加文章并发布十分方便
2. 利于维护，依赖尽可能简单和少
3. 利于扩展，受到的限制尽可能少，方便之后扩展。



## 技术选型

为了达到上述的目标，我也调研了一下各种技术。大的方面自然是React不动摇。一开始想着只使用react来实现，但是实际上我发现一个是react的加载速度还是有点慢，然后再在前端处理markdown再抽取文章的元信息会很棘手。所以最后还是找了一个React的静态化框架 - Gatsby.js。查了一下这个是一个比较流行的框架，社区相关的插件和讨论也很多，可以用来做数据的预处理，把网站静态化提高加载速度。同时这个框架还用了GraphQL作为数据获取的框架，对这个很感兴趣，据说是下一代web api，吊打REST api，刚好学学实践一下。CSS框架的选型则简单很多，我的要求就是轻巧简单同时不含js，因为我的目标不是真正做前端，所以CSS我也不会自己去写。最后选了一个Bulma。所以最终的方案就是

前端框架: React.js

静态化框架: Gatsby.js

CSS: Bulma



## 开干

网站的设计思路基本上就是抄袭我原来的网站，同时借鉴一下别人同一个框架下设计的好的网站（审美差就是没办法），其中给我借鉴最多的就是这个[Lin Millie 的博客](https://www.millielin.com/)。中间的过程自然不必说了，总共花了我五个晚上，最终的效果你们也看到了。其中我感觉有难度的部分有几个



#### graphQL的语法
graphQL真的很好用，而且很有意思的，他的用意就是让前端自己获取想要的字段，同时只限于哪些字段，官方说这样能减少每次请求的大小，同时减少请求次数，减少后端的无畏浪费。因为每次回复的字段都是指定的，没有浪费，所以减小请求大小这个确实没有问题，减少请求次数也是因为能指定请求返回的字段，不用想rest一样可能需要先请求a，a里面有b的id，再请求b从而的到最终的结果。想法是好的，但是实际上这么做对后端要求很高，如果后端没有相应的数据引擎，这个工作是没有办法支持的，因为每个请求的复杂度前端是不知道的，一个请求可能看起来很简单，但是实际上在传统的关系数据库里要做很多次join，非常的影响数据库的性能。所以这个方案我觉得需要一个配套的重新设计的后端引擎，查了一下发现facebook，netflix，github已经开始拥抱这个框架了，但是尴尬的是没有开源他们后端引擎的实现。所以我们可以一直关注一下，感觉是个趋势。

#### 动态生成静态网页
整个gatsby的思路其实是这样的，先是用graphQL实现react的结构化数据获取，不管是从哪来。然后需要你根据获取到的数据动态的生成网页，最后把这些网页用于展示。因为数据已经在网页生成的时候获取过了，所以整个网页实际上是静态的。虽然动态生成静态网页说起来有点绕，但是实际上理解一下也就这么回事。

#### gatsby的各种配置和插件
主要就是markdown渲染插件，他的作用就是渲染markdown作为一个对象，里面包含title，date，生成的html等。方便graphQL使用和我们生成页面。基本上大多数的插件都是用于转换数据给graphQL用的。

#### js及前端本身的一些基础知识
这个完全就是边实践边学习边踩坑。了解了一下前端是如何编译打包，如何进行包管理。还有我实在是想吐槽css，真的是一开始排版的人写的语言，各种语法莫名其妙，套用一个高端词汇叫不成交，不同定义之间互相干涉。最后程序员加入的flex和grid才真正的好用有规律。

## 结果
整个网站的源代码在 [bates-hu.github.io](https://github.com/bates-hu/bates-hu.github.io/tree/source)的source分支里，用了gh-page插件自动编译并把编译后的网站房子啊master分支中，也就是你们实际看到的网站。也基本上实现了我的目标。现在写文章也只要`npm run new {title}`就可以了，然后再在生成的md文件里写，写完了的话`npm start`在线预览，实时修改，最后`npm run delpoy`就了事。同时因为没有任何其他的数据库，托管商的依赖，维护起来很简单。代码也是自己写的，以后相加什么就加什么。十分满意，所以特赏赐此网站一个域名[hubingcheng.com](hubingcheng.com) :)

## 最后
自己写的网站，含着泪也要迭代下去。最近可能准备加上一个专栏用来放我自己的leetcode解题记录，然后还有就是网站的国际化。增加评论模块用于交流等。或者有啥想法也可以私信我哈哈。




